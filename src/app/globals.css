@layer base {
  /* Use dynamic viewport units for better mobile handling */
  .h-dvh {
    height: 100dvh;
  }

  /* Safe area padding for mobile browsers */
  .pb-safe {
    padding-bottom: max(0.75rem, env(safe-area-inset-bottom, 0.75rem));
  }

  @media (min-width: 768px) {
    .pb-safe {
      padding-bottom: 0;
    }
  }
}

/* Hide scrollbar for Chrome, Safari and Opera */
.scrollbar-hide::-webkit-scrollbar {
  display: none;
}

/* Hide scrollbar for IE, Edge and Firefox */
.scrollbar-hide {
  -ms-overflow-style: none; /* IE and Edge */
  scrollbar-width: none; /* Firefox */
}

/* Safari Mobile Scrolling Fix */
@supports (-webkit-touch-callout: none) {
  .safari-scroll-fix {
    overflow-y: scroll;
    -webkit-overflow-scrolling: touch;
    height: 100%;
  }
}

/* This ensures the sidebar height properly accounts for dynamic viewport height */
.h-screen {
  height: 100dvh; /* Dynamic viewport height - adjusts as the address bar appears/disappears */
}

@keyframes sheen {
  0% {
    background-position: -120% 0;
  }
  100% {
    background-position: 220% 0;
  }
}

/* Prevent vertical scrollbars in message content */
.katex-display {
  overflow-x: auto !important;
  overflow-y: hidden !important;
  max-width: 100%;
}

.katex-display > .katex {
  max-width: 100%;
  overflow-x: auto !important;
  overflow-y: visible !important;
  padding: 0.5rem 0;
}

/* Ensure code blocks don't create vertical scrollbars */
.prose pre {
  overflow-y: visible !important;
  max-height: none !important;
}

/* Prevent vertical scrollbars while maintaining horizontal scroll for wide content */
.prose {
  overflow-y: visible !important;
}

/* Prose responsive fixes */
.prose {
  max-width: 100% !important;
  overflow-wrap: break-word;
  word-wrap: break-word;
  min-width: 0; /* Allow prose to shrink */
}

/* Fix code blocks to be contained but scrollable */
.prose pre {
  max-width: 100%;
  overflow-x: auto !important; /* Force horizontal scroll for code blocks */
  overflow-y: visible;
  white-space: pre;
}

/* Ensure inline code wraps */
.prose code {
  word-break: break-word;
}

/* Tables should scroll horizontally when needed */
.table-container {
  max-width: 100%;
  overflow-x: auto;
  -webkit-overflow-scrolling: touch;
}

/* Prevent horizontal scroll at message level */
.prose > * {
  max-width: 100%;
}

/* Fix images */
.prose img {
  max-width: 100%;
  height: auto;
}

/* Fix blockquotes */
.prose blockquote {
  word-wrap: break-word;
}

/* Responsive adjustments for narrow screens */
@media (max-width: 640px) {
  /* Reduce code font size on very small screens */
  .prose pre {
    font-size: 0.75rem;
  }

  /* Make tables more compact */
  .prose table {
    font-size: 0.75rem;
  }

  /* Ensure long URLs break */
  .prose a {
    word-break: break-all;
  }
}

/* KaTeX specific overflow fixes */
.katex-html {
  overflow-x: auto !important;
  overflow-y: visible !important;
}

.katex .base {
  overflow-y: visible !important;
}

/* Subtle one-shot sheen for text clipped backgrounds */
/* Removed sheen styles */

/* Prevent browser scroll anchoring on dynamic streaming blocks */
.no-scroll-anchoring {
  overflow-anchor: none;
}
